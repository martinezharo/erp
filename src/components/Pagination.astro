---
interface Props {
    currentPage: number;
    totalPages: number;
    baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

const pages = [];
const maxVisible = 5;

// Simple logic to show a window of pages
let startPage = Math.max(1, currentPage - 2);
let endPage = Math.min(totalPages, startPage + maxVisible - 1);

if (endPage - startPage < maxVisible - 1) {
    startPage = Math.max(1, endPage - maxVisible + 1);
}

for (let i = startPage; i <= endPage; i++) {
    pages.push(i);
}

function getUrl(page: number) {
    // simple string manipulation is safer if baseUrl is just a path
    const separator = baseUrl.includes("?") ? "&" : "?";
    return `${baseUrl}${separator}page=${page}`;
}
---

{
    totalPages > 1 && (
        <nav
            class="flex justify-center items-center gap-2 mt-8"
            aria-label="Pagination"
        >
            {/* Previous Button */}
            <a
                href={currentPage > 1 ? getUrl(currentPage - 1) : "#"}
                class={`px-3 py-2 rounded-lg border border-white/10 flex items-center transition-all
                ${
                    currentPage > 1
                        ? "bg-white/5 hover:bg-white/10 text-slate-300 hover:text-white"
                        : "bg-transparent text-slate-600 cursor-not-allowed pointer-events-none"
                }`}
                aria-disabled={currentPage <= 1}
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-4 h-4"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                >
                    <path
                        fill-rule="evenodd"
                        d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"
                        clip-rule="evenodd"
                    />
                </svg>
                <span class="ml-1 hidden sm:inline">Anterior</span>
            </a>

            {/* Page Numbers */}
            <div class="flex items-center gap-1">
                {pages.map((page) => (
                    <a
                        href={getUrl(page)}
                        class={`w-10 h-10 flex items-center justify-center rounded-lg border text-sm font-medium transition-all
                        ${
                            page === currentPage
                                ? "bg-emerald-500/10 border-emerald-500/50 text-emerald-400"
                                : "bg-white/5 border-white/10 text-slate-400 hover:bg-white/10 hover:text-white"
                        }`}
                    >
                        {page}
                    </a>
                ))}
            </div>

            {/* Next Button */}
            <a
                href={currentPage < totalPages ? getUrl(currentPage + 1) : "#"}
                class={`px-3 py-2 rounded-lg border border-white/10 flex items-center transition-all
                ${
                    currentPage < totalPages
                        ? "bg-white/5 hover:bg-white/10 text-slate-300 hover:text-white"
                        : "bg-transparent text-slate-600 cursor-not-allowed pointer-events-none"
                }`}
                aria-disabled={currentPage >= totalPages}
            >
                <span class="mr-1 hidden sm:inline">Siguiente</span>
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-4 h-4"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                >
                    <path
                        fill-rule="evenodd"
                        d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                        clip-rule="evenodd"
                    />
                </svg>
            </a>
        </nav>
    )
}
